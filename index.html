<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lista de Tarefas com Background Preto</title>
  <style>
    /* Reset básico para margens e paddings */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #121212; /* fundo preto escuro */
      color: #eee;
      max-width: 600px;
      margin: 40px auto;
      padding: 0 20px;
      line-height: 1.5;
    }

    header h1 {
      text-align: center;
      font-weight: 700;
      color: #eee;
      margin-bottom: 35px;
      font-size: 2rem;
      letter-spacing: 1.2px;
    }

    input#novaTarefa {
      width: 70%;
      padding: 12px 14px;
      font-size: 1.1rem;
      border: 1.8px solid #555;
      border-radius: 6px;
      background: #222;
      color: #eee;
      transition: border-color 0.3s ease;
    }

    input#novaTarefa::placeholder {
      color: #aaa;
    }

    input#novaTarefa:focus {
      border-color: #349db3;
      outline: none;
      box-shadow: 0 0 8px rgba(52, 157, 179, 0.7);
      background: #2a2a2a;
    }

    button {
      padding: 12px 20px;
      font-size: 1.1rem;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      transition: background-color 0.3s ease;
      color: white;
      background-color: #349db3;
      margin-left: 10px;
      font-weight: 600;
      box-shadow: 0 2px 5px rgba(52, 157, 179, 0.8);
    }

    button:hover,
    button:focus {
      background-color: #2a7b91;
    }

    #filtros {
      margin-top: 30px;
      text-align: center;
    }

    #filtros button {
      width: 120px;
      background-color: #5c7a8a;
      margin: 0 8px;
      font-size: 1rem;
      padding: 10px 0;
      border-radius: 30px;
      box-shadow: 0 3px 6px rgba(92,122,138,0.5);
      color: #eee;
    }

    #filtros button[aria-pressed='true'] {
      background-color: #349db3;
      box-shadow: 0 4px 12px rgba(52, 157, 179, 1);
      font-weight: 700;
      color: white;
    }

    #filtros button:hover,
    #filtros button:focus {
      background-color: #2a7b91;
      outline: none;
    }

    ul#listaTarefas {
      list-style: none;
      margin-top: 35px;
      padding-left: 0;
    }

    li {
      background: #222;
      border-radius: 10px;
      margin-bottom: 15px;
      padding: 15px 18px;
      border: 1px solid #444;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 0 4px rgba(52, 157, 179, 0.3);
      transition: box-shadow 0.3s ease;
      color: #eee;
    }

    li:hover,
    li:focus-within {
      box-shadow: 0 0 10px rgba(52, 157, 179, 0.6);
      outline: none;
    }

    li.completed label {
      text-decoration: line-through;
      color: #7a7a7a;
    }

    label {
      display: flex;
      align-items: center;
      flex-grow: 1;
      cursor: pointer;
      font-size: 1.1rem;
      user-select: none;
      color: #eee;
    }

    label input[type='checkbox'] {
      margin-right: 15px;
      width: 22px;
      height: 22px;
      cursor: pointer;
      accent-color: #349db3;
    }

    .btn-editar,
    .btn-remover {
      border-radius: 6px;
      font-size: 0.9rem;
      padding: 6px 14px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
      user-select: none;
      width: 80px;
      margin-left: 12px;
      transition: background-color 0.3s ease;
      color: white;
    }

    .btn-editar {
      background-color: #349db3;
    }

    .btn-editar:hover,
    .btn-editar:focus {
      background-color: #2a7b91;
      outline: none;
    }

    .btn-remover {
      background-color: #e74c3c;
    }

    .btn-remover:hover,
    .btn-remover:focus {
      background-color: #b83833;
      outline: none;
    }

    #msgErro {
      color: #e74c3c;
      margin-top: 10px;
      font-weight: 700;
      text-align: center;
      font-size: 1rem;
      user-select: none;
    }

    @media (max-width: 600px) {
      #novaTarefa {
        width: 100%;
        margin-bottom: 12px;
      }

      button {
        width: 100%;
        margin-left: 0;
        margin-bottom: 12px;
      }

      #filtros button {
        width: 33.33%;
        margin: 4px 0;
        font-size: 1rem;
      }

      li {
        flex-direction: column;
        align-items: flex-start;
      }

      label {
        font-size: 1rem;
      }

      .btn-editar,
      .btn-remover {
        width: 100%;
        margin: 6px 0 0 0;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>Minha Lista de Tarefas</h1>
  </header>
  <main>
    <section aria-labelledby="adicionar-tarefa-label">
      <h2 id="adicionar-tarefa-label" class="visually-hidden">Adicionar nova tarefa</h2>
      <input type="text" id="novaTarefa" aria-label="Digite uma nova tarefa" placeholder="Digite uma nova tarefa" />
      <button onclick="adicionarTarefa()" aria-label="Adicionar tarefa">Adicionar</button>
      <div id="msgErro" role="alert" aria-live="assertive"></div>
    </section>
    <nav aria-label="Filtro de tarefas" id="filtros">
      <button onclick="filtrar('todas')" aria-pressed="true">Todas</button>
      <button onclick="filtrar('pendentes')" aria-pressed="false">Pendentes</button>
      <button onclick="filtrar('concluidas')" aria-pressed="false">Concluídas</button>
    </nav>
    <section aria-labelledby="lista-tarefas-label">
      <h2 id="lista-tarefas-label" class="visually-hidden">Lista de tarefas</h2>
      <ul id="listaTarefas"></ul>
    </section>
  </main>

  <script>
    const novaTarefaInput = document.getElementById('novaTarefa');
    const listaTarefas = document.getElementById('listaTarefas');
    const msgErro = document.getElementById('msgErro');
    const botoesFiltro = document.querySelectorAll('#filtros button');

    let tarefas = [];
    let filtroAtual = 'todas';

    function salvarTarefas() {
      localStorage.setItem('tarefas', JSON.stringify(tarefas));
    }

    function carregarTarefas() {
      const tarefasSalvas = localStorage.getItem('tarefas');
      if (tarefasSalvas) {
        tarefas = JSON.parse(tarefasSalvas);
        renderizarTarefas();
      }
    }

    function filtrar(filtro) {
      filtroAtual = filtro;
      atualizarEstadoFiltro();
      renderizarTarefas();
    }

    function atualizarEstadoFiltro() {
      botoesFiltro.forEach((botao) => {
        botao.setAttribute('aria-pressed', 'false');
      });
      document
        .querySelector(`#filtros button[onclick="filtrar('${filtroAtual}')"]`)
        .setAttribute('aria-pressed', 'true');
    }

    function renderizarTarefas() {
      listaTarefas.innerHTML = '';
      tarefas.forEach((tarefa, index) => {
        if (
          filtroAtual === 'todas' ||
          (filtroAtual === 'pendentes' && !tarefa.concluida) ||
          (filtroAtual === 'concluidas' && tarefa.concluida)
        ) {
          const li = document.createElement('li');
          if (tarefa.concluida) {
            li.classList.add('completed');
          }

          const label = document.createElement('label');
          const checkbox = document.createElement('input');
          checkbox.type = 'checkbox';
          checkbox.checked = tarefa.concluida;
          checkbox.setAttribute('aria-label', `Marcar tarefa '${tarefa.texto}' como concluída`);

          checkbox.addEventListener('change', () => {
            tarefas[index].concluida = checkbox.checked;
            salvarTarefas();
            renderizarTarefas();
          });

          label.appendChild(checkbox);
          label.appendChild(document.createTextNode(tarefa.texto));
          li.appendChild(label);

          // Botões editar e excluir
          const botaoEditar = document.createElement('button');
          botaoEditar.textContent = 'Editar';
          botaoEditar.className = 'btn-editar';
          botaoEditar.setAttribute('aria-label', `Editar tarefa: ${tarefa.texto}`);

          const botaoExcluir = document.createElement('button');
          botaoExcluir.textContent = 'Excluir';
          botaoExcluir.className = 'btn-remover';
          botaoExcluir.setAttribute('aria-label', `Excluir tarefa: ${tarefa.texto}`);

          botaoEditar.addEventListener('click', function (e) {
            e.stopPropagation();

            const inputEditar = document.createElement('input');
            inputEditar.type = 'text';
            inputEditar.size = 25;
            inputEditar.value = tarefa.texto;

            li.textContent = '';
            li.appendChild(inputEditar);
            inputEditar.focus();

            function finalizarEdicao() {
              const novoTexto = inputEditar.value.trim();
              if (novoTexto !== '') {
                tarefas[index].texto = novoTexto;
                salvarTarefas();
                renderizarTarefas();
              } else {
                renderizarTarefas();
              }
            }

            inputEditar.addEventListener('blur', finalizarEdicao);
            inputEditar.addEventListener('keydown', (event) => {
              if (event.key === 'Enter') {
                inputEditar.blur();
              }
            });
          });

          botaoExcluir.addEventListener('click', (e) => {
            e.stopPropagation();
            tarefas.splice(index, 1);
            salvarTarefas();
            renderizarTarefas();
          });

          li.appendChild(botaoEditar);
          li.appendChild(botaoExcluir);

          listaTarefas.appendChild(li);
        }
      });
    }

    novaTarefaInput.addEventListener('input', () => {
      msgErro.style.display = 'none';
    });

    function adicionarTarefa() {
      const texto = novaTarefaInput.value.trim();
      if (texto === '') {
        msgErro.textContent = 'Por favor, digite uma tarefa válida!';
        msgErro.style.display = 'block';
        return;
      }
      msgErro.style.display = 'none';
      tarefas.push({ texto: texto, concluida: false });
      salvarTarefas();
      renderizarTarefas();
      novaTarefaInput.value = '';
    }

    window.onload = () => {
      carregarTarefas();
      atualizarEstadoFiltro();
    };
  </script>
</body>
</html>
